---
layout:		post
title:		"[BZOJ3456]城市规划"
date:		2019-03-03
author:		"Dispwnl"
header-img:	"img/used/"
catalog:	false
tags:
    - 多项式运算
    - FFT/NTT
---

## [题目](https://lydsy.com/JudgeOnline/problem.php?id=3456)

### Description

刚刚解决完电力网络的问题, 阿狸又被领导的任务给难住了.

刚才说过, 阿狸的国家有n个城市, 现在国家需要在某些城市对之间建立一些贸易路线, 使得整个国家的任意两个城市都直接或间接的连通. 为了省钱, 每两个城市之间最多只能有一条直接的贸易路径. 对于两个建立路线的方案, 如果存在一个城市对, 在两个方案中是否建立路线不一样, 那么这两个方案就是不同的, 否则就是相同的. 现在你需要求出一共有多少不同的方案.

好了, 这就是困扰阿狸的问题. 换句话说, 你需要求出n个点的简单(无重边无自环)无向连通图数目.
由于这个数字可能非常大, 你只需要输出方案数mod 1004535809(479 * 2 ^ 21 + 1)即可.

### Input

仅一行一个整数n(<=130000)

### Output

仅一行一个整数, 为方案数 mod 1004535809.


### Sample Input
```plain
3
```
### Sample Output
```plain
4
```

### HINT

对于 100%的数据, n <= 130000

### 题解

如果要求$n$个点形成的图，那么答案就是$\sum_{i=0}^{C_{n}^{2}}C_{C_{2}^{n}}^i$，即$2^{\frac{n(n-1)}{2}}$

发现所有的图的个数等于某些点形成连通图，其他点任意连的方案数之和

如果设$F(n)=2^{\frac{n(n-1)}{2}}$，$f(n)$表示$n$个点形成连通图的方案数，则有

$F(n)=\sum_{i=1}^{n}f(i)F(n-i)C_{n-1}^{i-1}$

可以这么理解这个式子：$1$号节点肯定要在一个连通块之内，所有考虑枚举$1$号节点所在连通块大小，这样$i$个节点时共有$C_{n-1}^{i-1}$种情况，同时乘上其他随意连的点的方案数

可以把$C_{n-1}^{i-1}​$拆开，