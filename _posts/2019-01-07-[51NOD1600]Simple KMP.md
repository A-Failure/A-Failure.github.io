---
layout:     post
title:      "[51NOD1600]Simple KMP"
date:       2019-01-07
author:     "Dispwnl"
header-img: "img/used/989.jpg"
catalog: false
tags:
    - 后缀自动机
    - 树链剖分
---
## [题目](http://www.51nod.com/Challenge/Problem.html#!#problemId=1600)
### 题目描述
对于一个字符串$\vert S\vert$，我们定义fail[i]，表示最大的x使得S[1..x]=S[i-x+1..i]，满足$x<i$

显然对于一个字符串，如果我们将每个$0\le i\le\vert S\vert$看成一个结点，除了i=0以外i向fail[i]连边，这是一颗树的形状，根是0

我们定义这棵树是$G(S)$，设$f(S)$是$G(S)$中除了0号点以外所有点的深度之和，其中0号点的深度为-1
定义$key(S)$等于$S$的所有非空子串$S'$的$f(S')$之和

给定一个字符串$S$，现在你要实现以下几种操作：

1.在$S$最后面加一个字符

2.询问$key(S)$

善良的出题人不希望你的答案比<code>long long</code>大，所以你需要将答案对1e9+7取模

### 输入
第一行一个正整数Q

Q<=10^5

第二行一个长度为Q的字符串$S$
### 输出
输出Q行，第i行表示前i个字符组成的字符串的答案
### 输入样例
```
5
abaab
```
### 输出样例
```
0
0
1
4
9
```

